# 文件复制工具 (File Copier)

一个用于批量复制或移动文件的工具，支持按文件类型和关键词筛选，可通过图形界面或命令行操作，适合文件整理和归档。

## 功能特点

- 支持文件复制和移动操作
- 可按文件扩展名筛选
- 支持按关键词包含/排除文件
- 可选择是否保留原有文件夹结构
- 可选的操作日志记录功能
- 实时显示操作进度和详细信息
- 支持命令行和图形界面两种操作方式
- 提供打包好的可执行文件，无需安装Python环境

## 安装

### 方式一：直接使用（推荐）

1. 下载发布页面中的可执行文件 `文件复制工具.exe`
2. 双击运行即可，无需安装任何依赖

### 方式二：从源码运行

1. 克隆或下载本仓库
2. 安装依赖：
   ```
   pip install -r requirements.txt
   ```

## 使用方法

### 图形界面模式

1. 如果使用可执行文件，直接双击 `文件复制工具.exe` 运行

2. 如果从源码运行，可以：
   - 直接运行启动脚本：
     ```
     python start_ui.py
     ```
   - 或者通过命令行参数启动图形界面：
     ```
     python file_copier.py -g
     ```

3. 界面功能说明：
   - 源目录：选择要处理的文件所在目录
     - "浏览"按钮：选择目录
     - "扫描"按钮：分析目录中的文件类型及数量
   - 目标目录：选择文件要复制/移动到的目录
   - 操作模式：选择复制或剪切
   - 保留原有文件夹结构：是否在目标目录中保持源目录的文件夹结构
   - 记录日志：是否在目标目录中生成详细的操作日志文件
   - 文件后缀：指定要处理的文件类型（空格分隔，如：txt pdf）
   - 包含/排除关键词：根据文件名筛选文件
   - 输出信息：实时显示操作进度和结果

### 命令行模式

使用命令行模式可以更灵活地处理文件，支持以下参数：

```bash
python file_copier.py 源目录 目标目录 [后缀名...] [选项]

位置参数:
  源目录            要处理的源目录路径
  目标目录          文件复制/移动的目标目录路径
  后缀名            要处理的文件后缀名列表（例如：txt pdf）

选项:
  -h, --help       显示帮助信息
  -i, --include    文件名包含的关键字（不含扩展名）
  -e, --exclude    要排除的文件名关键字（不含扩展名）
  -x, --move       使用移动而不是复制
  -k, --keep       保留原有的文件夹结构（默认不保留）
  -g, --gui        启动图形用户界面
  -l, --list       分析指定目录中的文件类型及其数量
```

示例：

1. 复制所有 PDF 和 TXT 文件：
   ```bash
   python file_copier.py D:\源目录 E:\目标目录 pdf txt
   ```

2. 移动包含"报告"的 Excel 文件：
   ```bash
   python file_copier.py D:\源目录 E:\目标目录 xlsx -x -i 报告
   ```

3. 复制所有文件，但排除包含"临时"的文件：
   ```bash
   python file_copier.py D:\源目录 E:\目标目录 -e 临时
   ```

4. 保持原有目录结构复制文件：
   ```bash
   python file_copier.py D:\源目录 E:\目标目录 -k
   ```

5. 分析目录中的文件类型及数量：
   ```bash
   python file_copier.py -l D:\要分析的目录
   ```

注意事项：
- 如果不指定文件后缀，则处理所有文件
- 多个包含/排除关键词用空格分隔
- 文件后缀名不需要包含点号（直接写 pdf 而不是 .pdf）
